* Add gradient checking and make it optional
